<!-- test_delete.html -->
<!DOCTYPE html>
<html>

<body>
    <h1>Test Admin Delete Endpoint</h1>
    <input type="number" id="userId" placeholder="User ID to delete" value="2">
    <input type="password" id="password" placeholder="Admin password">
    <button onclick="testDelete()">Test Delete</button>

    <div id="result" style="margin-top: 20px; padding: 10px; background: #f0f0f0; white-space: pre-wrap;"></div>

    <script>
        function testDelete() {
            const userId = document.getElementById('userId').value;
            const password = document.getElementById('password').value;
            const resultDiv = document.getElementById('result');

            resultDiv.textContent = 'Testing...\n';

            const formData = new FormData();
            formData.append('user_id', userId);
            formData.append('password', password);

            fetch('../admin/user_delete.php', {
                method: 'POST',
                body: formData
            })
                .then(response => {
                    resultDiv.textContent += `Status: ${response.status}\n`;
                    resultDiv.textContent += `Status Text: ${response.statusText}\n`;

                    // Get all headers
                    const headers = {};
                    response.headers.forEach((value, key) => {
                        headers[key] = value;
                    });
                    resultDiv.textContent += `Headers: ${JSON.stringify(headers, null, 2)}\n\n`;

                    return response.text();
                })
                .then(text => {
                    resultDiv.textContent += `Raw Response:\n${text}\n\n`;

                    if (text.trim() === '') {
                        resultDiv.textContent += '⚠️ EMPTY RESPONSE!\n';
                    } else {
                        try {
                            const json = JSON.parse(text);
                            resultDiv.textContent += '✅ Valid JSON:\n';
                            resultDiv.textContent += JSON.stringify(json, null, 2);
                        } catch (e) {
                            resultDiv.textContent += '❌ Invalid JSON:\n';
                            resultDiv.textContent += `Error: ${e.message}\n`;

                            // Check for PHP errors
                            if (text.includes('Parse error') || text.includes('Fatal error') || text.includes('Warning') || text.includes('Notice')) {
                                resultDiv.textContent += '\n⚠️ PHP ERROR DETECTED!\n';
                            }
                        }
                    }
                })
                .catch(error => {
                    resultDiv.textContent += `❌ Fetch Error: ${error.message}\n`;
                });
        }
    </script>
</body>

</html>